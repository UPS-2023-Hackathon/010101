#checks whether a given latitude and longitude pair falls inside or outside a geofence defined by a set of coordinates.
#the data for coordinates is being taken from dataset file in the geofence sheet
#Code is raw and needs changes

def is_inside_polygon(x, y, polygon):
    n = len(polygon)
    inside = False
    p1x, p1y = polygon[0]
    for i in range(n + 1):
        p2x, p2y = polygon[i % n]
        if y > min(p1y, p2y):
            if y <= max(p1y, p2y):
                if x <= max(p1x, p2x):
                    if p1y != p2y:
                        xints = (y - p1y) * (p2x - p1x) / (p2y - p1y) + p1x
                    if p1x == p2x or x <= xints:
                        inside = not inside
        p1x, p1y = p2x, p2y
    return inside

def check_geofence(lat, lon, coordinates):
    for polygon in coordinates:
        polygon_points = []
        for i in range(0, len(polygon), 2):
            polygon_points.append((float(polygon[i]), float(polygon[i+1])))
        if is_inside_polygon(lon, lat, polygon_points):
            return True
    return False

latitude = 38.13152553700007
longitude = -85.72045703999999

coordinates = [
    [
        38.13152553700007, -85.72045703999999,
        38.12337597900006, -85.72355956999996,
        38.122111397000026, -85.71968758199995,
        38.13009773700003, -85.71680315899994,
        38.131861505000074, -85.71685596899994,
        38.132642256000054, -85.71749532899997,
        38.13292672700004, -85.71804147499995,
        38.13195888300004, -85.72089466099999,
        38.13152553700007, -85.72045703999999
    ],
    [
        38.1589578023605, -85.7238721847534,
        38.1589915466738, -85.7267045974732,
        38.1590927795198, -85.7278203964234,
        38.1595314535618, -85.7294082641602,
        38.1595651976095, -85.7301378250122,
        38.1592615006175, -85.7309532165528,
        38.158316657442, -85.7316398620606,
        38.1574392921024, -85.7319831848145,
        38.1575067821187, -85.7324552536011,
        38.1581141894544, -85.7324981689453,
        38.1587215917306, -85.7333135604859,
        38.1583504020519, -85.7361030578614,
        38.1560894786594, -85.7355451583862,
        38.1546046550143, -85.7364892959595,
        38.1534910174411, -85.7366180419922,
        38.1536260047193, -85.7412099838257,
        38.1543684302834, -85.7425832748413,
        38.1606449988926, -85.7446002960205,
        38.1659425422446, -85.7468962669373,
        38.1664823976605, -85.744686126709,
        38.1548408789801, -85.7407808303833,
        38.1537947384657, -85.7397508621216,
        38.1539972184461, -85.7370901107788,
        38.155178340461, -85.7368755340576,
        38.1560219873314, -85.736403465271,
        38.177042515115, -85.7424545288086,
        38.1772111946708, -85.741810798645,
        38.1732302530261, -85.7285928726196,
        38.1631082357202, -85.7252883911133,
        38.1627370683727, -85.724515914917,
        38.1632769475262, -85.7219409942627,
        38.1629057810376, -85.7218980789184,
        38.160341306398, -85.7220697402954,
        38.1593289889472, -85.7226705551148,
        38.1589578023605, -85.7238721847534
    ],
    [
        40.844023640000046, -74.42147760299997,
        40.84294840300004, -74.41800689699994,
        40.845182796000074, -74.41675559099997,
        40.845460021000065, -74.41690874199998,
        40.845973091000076, -74.41861844099998,
        40.84573772600004, -74.41974765099997,
        40.84546583600007, -74.41991662999999,
        40.84541105300008, -74.42023312999999,
        40.84524873000004, -74.42043966099999,
        40.84511887200006, -74.42036187599996,
        40.844023640000046, -74.42147760299997
    ]
]

if check_geofence(latitude, longitude, coordinates):
    print("Inside the geofence.")
else:
    print("Outside the geofence.")
